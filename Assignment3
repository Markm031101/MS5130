library(tidyverse)

Total_Rainfall_df <- read_csv("C:/Users/markm/OneDrive/Desktop/Rsstudio/Total_Rainfall.csv")
Total_Sunshine_df <- read_csv("C:/Users/markm/OneDrive/Desktop/Rsstudio/Total_Sunshine.csv")
Total_Degrees_df <- read_csv("C:/Users/markm/OneDrive/Desktop/Rsstudio/Total_Degrees.csv")

colnames(Total_Rainfall_df)
colnames(Total_Sunshine_df)
colnames(Total_Degrees_df)

Total_Rainfall_df <- Total_Rainfall_df %>% drop_na()
Total_Degrees_df <- Total_Degrees_df %>% drop_na()
Total_Sunshine_df <- Total_Sunshine_df %>% drop_na()

Total_Rainfall_df <- Total_Rainfall_df %>% distinct()
Total_Degrees_df <- Total_Degrees_df %>% distinct()
Total_Sunshine_df <- Total_Sunshine_df %>% distinct()


Total_Rainfall_df <- Total_Rainfall_df %>%
  rename(Rainfall_Stat = `Statistic Label`, Rainfall_Value = VALUE)

Total_Degrees_df <- Total_Degrees_df %>%
  rename(Degrees_Stat = `Statistic Label`, Degrees_Value = VALUE)

Total_Sunshine_df <- Total_Sunshine_df %>%
  rename(Sunshine_Stat = `Statistic Label`, Sunshine_Value = VALUE)



Total_Rainfall_df <- Total_Rainfall_df %>%
  select(-STATISTIC, -`TLIST(M1)`, -C02431V02938, -UNIT)
Total_Sunshine_df <- Total_Sunshine_df %>%
  select(-STATISTIC, -`TLIST(M1)`, -C02431V02938, -UNIT)
Total_Degrees_df <- Total_Degrees_df %>%
  select(-STATISTIC, -`TLIST(M1)`, -C02431V02938, -UNIT)


colnames(Total_Rainfall_df)
colnames(Total_Sunshine_df)
colnames(Total_Degrees_df)

glimpse(Total_Rainfall_df)
glimpse(Total_Sunshine_df)
glimpse(Total_Degrees_df)

summary(Total_Rainfall_df)
summary(Total_Sunshine_df)
summary(Total_Degrees_df)

Total_Rainfall_df <- Total_Rainfall_df %>%
  filter(!(Month >= "1958M01" & Month <= "1990M12"))

Total_Sunshine_df <- Total_Sunshine_df %>%
  filter(!(Month >= "1958M01" & Month <= "1990M12"))

Total_Degrees_df <- Total_Degrees_df %>%
  filter(!(Month >= "1958M01" & Month <= "1990M12"))

Total_Degrees_df <- Total_Degrees_df %>%
  filter(grepl("mean temperature", Degrees_Stat, ignore.case = TRUE))


Total_Sunshine_df <- Total_Sunshine_df %>%
  filter(grepl("Total Sunshine Hours", Sunshine_Stat, ignore.case = TRUE))


Total_Rainfall_df <- Total_Rainfall_df %>%
  filter(grepl("Total Rainfall", Rainfall_Stat, ignore.case = TRUE))



summary(Total_Rainfall_df)
summary(Total_Sunshine_df)
summary(Total_Degrees_df)

glimpse(Total_Rainfall_df)
glimpse(Total_Sunshine_df)
glimpse(Total_Degrees_df)



merged_df <- merge(Total_Rainfall_df, Total_Sunshine_df, by = c("Month","Meteorological Weather Station"))

merged_df <- merge(merged_df, Total_Degrees_df, by = c("Month","Meteorological Weather Station"))

merged_df <- merged_df %>%
  select(Month, 
         `Meteorological Weather Station`,
         Rainfall_Stat,
         Rainfall_Value,  
         Sunshine_Stat,
         Sunshine_Value,  
         Degrees_Stat,
         Degrees_Value)     
